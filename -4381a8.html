<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>HADOOP&nbsp;|&nbsp;Welcome to Robin’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="HADOOP">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🌌&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="-d98406.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About ME</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🌌&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">HADOOP</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Aug 17, 2019</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/大数据.html">大数据</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/4381a8a87c1a44df9cc46ea741b2a82e" class="PageRoot"><ul id="https://www.notion.so/b1a9db95aed349c18bc122a65b693474" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/3efe54d5d639416da08da4e0847f7ac9"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Hadoop是什么？</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ffddc0ecc479473a8a956a323a5b4337"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">基本概念</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/69115b85d768453498009971a5d86a8a"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Hadoop的构建模块</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/de67e06f5f984f8ca6141678d4687112"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">HDFS - 分布式文件系统</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ef439fd547784f708f2bab4e22c719a9"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">YARN</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/522caa5298964be894ee6d4dffa2f84d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">MapReduce</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b94223b0498e46b1b43a14a5794f8a3d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">Hive</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e5fe4d03bc1b490f83e45d5cd540761d"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Hadoop和Spark 的区别</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/698f64a430fc46479ae82925e3c93ab0"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Spark是什么？</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/905b26b344794fb6ba2e67dcf0336e8d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">基本概览</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3d5a2139f5c94cc4b0b89b7054975f32"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Spark 生态系统包含五个关键组件</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8f34a0b532dc4e809e99f7fa96700e95"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">KEY TERMS</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/34dbdd9934a143dbb8689c847a88332f"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">RDD</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/43816690f1dc4897adbf695430fc4701"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">DataFrame</mark></span></span></div></a></li></ul><h1 id="https://www.notion.so/3efe54d5d639416da08da4e0847f7ac9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/3efe54d5d639416da08da4e0847f7ac9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Hadoop是什么？</mark></span></span></h1><h2 id="https://www.notion.so/ffddc0ecc479473a8a956a323a5b4337" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ffddc0ecc479473a8a956a323a5b4337"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">基本概念</mark></span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/874b3ec9f7a34a6a8f9af2efab49f908" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Apache Hadoop 是一种开源框架，用于高效存储和处理从 GB 级到 PB 级的大型数据集。利用 Hadoop，可以将多台计算机组成集群以便更快地并行分析海量数据集。</span></span></li><li id="https://www.notion.so/09841da538a64e40948539f460fe809c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">狭义上的Hadoop框架可可以概括为：Hadoop = HDFS(分布式文件系统，用于解决大数据存储) + MapReduce(分布式运算框架) + YARN(管理与监控集群节点和资源使用情况，对作业和任务进行安排)</span></span></li><li id="https://www.notion.so/3a0cb951cf7049f2a4a2d1bd0ad65dd1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">广义上可指代Hadoop生态圈，除了 HDFS、YARN 和 MapReduce 以外，整个 Hadoop 开源生态系统仍在不断发展，其中包括许多可帮助收集、存储、处理、分析和管理大数据的工具和应用。例如 Apache Pig、Apache Hive、Apache HBase、Apache Spark、Presto 和 Apache Zeppelin。</span></span></li></ul><h2 id="https://www.notion.so/69115b85d768453498009971a5d86a8a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/69115b85d768453498009971a5d86a8a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Hadoop的构建模块</mark></span></span></h2><h3 id="https://www.notion.so/de67e06f5f984f8ca6141678d4687112" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/de67e06f5f984f8ca6141678d4687112"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">HDFS - 分布式文件系统</mark></span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/7e8a351f6a054ed0a7b6a7e12edb3a6a" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">理解HDFS</strong></span></span><div id="https://www.notion.so/5c90839a175d48e28853479deba86a50" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">多台计算机联网协同工作(有时也称为一个集群)就像单台系统一样解决某种问题，这样的系统我们称之为分布式系统。 分布式文件系统是分布式系统的一个子集，它们解决的问题就是数据存储。换句话说，它们是横跨在多台计算机上的存储系统。存储在分布式文件系统上的数据自动分布在不同的节点上。Hadoop在分布式计算与分布式存付中都采用了主/从(Master/slave)结构.</span></span></p></div></li><li id="https://www.notion.so/442c02abd53c4b53bd86c5651038bc6b" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">分离元数据和数据：NameNode和DataNode</strong></strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/0ec4195375d743fcbaac7e9fc92873d6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">NameNode：集群中的主要节点，主要用于管理及群众的各种数据。运行NameNode消耗大量的内存与IO资源。因此,为了减轻机器的负载，驻留NameNode的服务器通常不会存储用户数据或者执行MapReduce程序的计算任务。这意味着NameNode服务器不会同时是DataNode或者TaskTracker.</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/125890f1725a42288209ebbe2374a42e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">NameNode是Hadoop守护进程中最重点的一个，是master。</span></span></li><li id="https://www.notion.so/b5016649411043389c837bd9b6cecc4b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">管理HDFS元数据，例如文件路径，大小，权限，文件的block切片信息等。(元数据：描述文件信息，并非文件内部的真实内容。)</span></span></li><li id="https://www.notion.so/b4ef29abfd10427a987c48202f4c7403" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">配置副本策略。</span></span></li><li id="https://www.notion.so/224323601cd6430290f05fb415646c14" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">处理客户端的读写请求。</span></span></li></ul></li><li id="https://www.notion.so/b4732357040948bc9ee585136b3787da" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">DataNode：负责执行NameNode下达的命令，当希望对HDFS文件进行读写时,文件被分割为多个块,由NameNode告知客户端每个数据块驻留在那个DataNode，客户端直接与DataNode守护进程通信,来处理与数据块相对应的本地文件.然而DataNode会与其他DataNode进行通信,复制这些数据块以实现冗余。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/a0b556aacb0848e389e98e91c776b470" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">通过心跳来向NameNode汇报自己还在工作。</span></span></li><li id="https://www.notion.so/d797e11b60824b25b7f190dd75bb5457" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">将HDFS数据块读取或者写入到本地文件系统的实际文件中.</span></span></li><li id="https://www.notion.so/7c3c84370b5f4aa7ab6c4e5ecf6a5b4c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">执行数据块的读写操作。</span></span></li><li id="https://www.notion.so/0bf43d0180c24750b0d664f7a347dbf9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">定时向NameNode汇报block信息。</span></span></li></ul></li><li id="https://www.notion.so/8e213b7783c34eb98991acd9c2e09574" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Secondary NameNode：协助NameNode管理。并非NameNode的替补，当NameNode故障可辅助恢复NameNode。NameNode是Hadoop集群的单一故障点，SNN的快照可以有助于减少停机的时间并降低数据丢失的风险。</span></span><div id="https://www.notion.so/a19c7f3b7c0f465492c969b9e6be1bf9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">NameNode的失效处理需要人工的干预,即手动地重新配置集群，将SNN用作主要的NameNode.</span></span></p></div></li></ul></li><li id="https://www.notion.so/b2530e0aa4e5418eabb51a93288c890e" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HDFS的副本机制</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/b0e4b61dc409445088bd52e8e6fe2604" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">HDFS将每个文件存储成一系列的数据块，这个数据块称为block。为了容错，每个block都会有副本，以供block丢失或宕机时可以自动恢复。默认情况下每个block都有三个副本。</span></span></li><li id="https://www.notion.so/5f9225556efb4eafa0a6d208208fce7d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">当一切运行正常时，DataNode会周期性发送心跳信息给NameNode(默认是每3秒钟一次)。如果NameNode在预定的时间内没有收到心跳信息(默认是10分钟)，它会认为DataNode出问题了，把它从集群中移除，并且启动一个进程去恢复数据。DataNode可能因为多种原因脱离集群，如硬件故障、主板故障、电源老化和网络故障等。</span></span></li><li id="https://www.notion.so/ba078e0f2cfc434a83efc7bcfcf6521a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对于HDFS来说，丢失一个DataNode意味着丢失了存储在它的硬盘上的数据块的副本。假如在任意时间总有超过一个副本存在(默认3个)，故障将不会导致数据丢失。当一个硬盘故障时，HDFS会检测到存储在该硬盘的数据块的副本数量低于要求，然后主动创建需要的副本，以达到满副本数状态。</span></span></li></ul></li><li id="https://www.notion.so/a969d96a17fc47a48c758d3263fabf9d" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">JobTracker</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/123363be09db41718b83d92a41122f50" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JobTracker守护进程是应用程序和Hadoop之间的纽带。</span></span><div id="https://www.notion.so/9021ab2f3ddc41aaa42c46638fec735e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一旦提交代码到集群上，JobTracker就会确定执行计划，包括决定处理哪些文件，为不同的任务分配节点以及监控所有任务的运行。如果任务失败，JobTracker将自动重启任务，但所分配的节点可能会不同，同时受到预定义的重试次数限制。</span></span></p></div></li><li id="https://www.notion.so/941106dec91f48cb8637b9b6e8e085d3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">每一个Hadoop集群只有一个JobTracker守护进程,它通常运行在服务器集群的主节点上。</span></span></li></ul></li><li id="https://www.notion.so/9d5b6505511f48cfb7f61b7b1ef12a91" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TaskTracker</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/f49b69c96f894dfb8521cfd7bbc60d86" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">与存储的守护进程一样，计算的守护进程也遵循主从架构：JobTracker作为主节点，监测MapReduce作业的整个执行过程。同时，TaskTracker管理各个任务在每个从节点上的执行情况。</span></span></li><li id="https://www.notion.so/d467786f329247ea9b72ae915e1977ad" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">TaskTracker的一个职责就是负责持续不断地与JobTracker通讯。如果JobTracker在指定的时间内没有收到来自TaskTracker的心跳，它会假定TaskTracker已经崩溃，进而重新提交相应的任务到集群的其他节点中。</span></span></li></ul></li><li id="https://www.notion.so/4cbbfdac580f473686ef0bf013bf40d4" class="NumberedList" value="6"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HDFS写过程</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/2396c2706e9a45c6a07ea64ed6bb4217" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">NameNode负责管理存储在HDFS上所有文件的元数据，它会确认客户端的请求，并记录下文件的名字和存储这个文件的DataNode集合。它把该信息存储在内存中的文件分配表里。</span></span></li><li id="https://www.notion.so/f3d213b9cd1149c2b995a970a2ce4982" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">EXAMPLE：客户端发送一个请求给NameNode，说它要将“zhou.log”文件写入到HDFS。那么，其执行流程可如下描述。</span></span><div id="https://www.notion.so/5657460101224256a7b4eeb171216e08" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F76351c4f-ad43-436f-906d-de4da3368313%2FUntitled.png?width=1440&amp;table=block&amp;id=56574601-0122-4256-a7b4-eeb171216e08"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F76351c4f-ad43-436f-906d-de4da3368313%2FUntitled.png?width=1440&amp;table=block&amp;id=56574601-0122-4256-a7b4-eeb171216e08" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li></ul></li><li id="https://www.notion.so/06df029708f2494b99db60d8eb80b894" class="NumberedList" value="7"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HDFS读过程</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/f14730e4481a4f9baa6056f0bf74b46b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">为了理解读的过程，可以认为一个文件是由存储在DataNode上的数据块组成的。</span></span></li><li id="https://www.notion.so/e8f3dd45e084409a910da138810ed392" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">EXAMPLE：客户端查看之前写入的内容的过程可如下描述。</span></span><div id="https://www.notion.so/b39b6aee399a430dbb4be5df3f3b3d81" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc33cffe1-76c1-44fa-9251-a09396f1b34d%2FUntitled.png?width=1518&amp;table=block&amp;id=b39b6aee-399a-430d-bb4b-e5df3f3b3d81"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc33cffe1-76c1-44fa-9251-a09396f1b34d%2FUntitled.png?width=1518&amp;table=block&amp;id=b39b6aee-399a-430d-bb4b-e5df3f3b3d81" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li></ul></li><li id="https://www.notion.so/67762b8088924898a10b5ec6c554a71c" class="NumberedList" value="8"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">跨多个DataNode切分文件</strong></strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/882b9efde42a47bdac72cb87801d8a1f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">在HDFS里，文件被切分成</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据块</strong></span><span class="SemanticString">，通常每个数据块64MB~128MB，然后每个数据块被写入文件系统。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">同一个文件的不同数据块不一定保存在相同的DataNode上</strong></span><span class="SemanticString">。这样做的好处是，当对这些文件执行运算时，能够通过</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">并行方式读取和处理文件的不同部分</strong></span><span class="SemanticString">。</span></span></li><li id="https://www.notion.so/df1bd5760166432c8071c231f1974c99" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">当客户端准备写文件到HDFS并询问NameNode应该把文件写到哪里时，NameNode会告诉客户端，那些可以写入数据块的DataNode。写完一批数据块后，客户端会回到NameNode获取新的DataNode列表，把下一批数据块写到新列表中的DataNode上。</span></span></li></ul></li></ol><h3 id="https://www.notion.so/ef439fd547784f708f2bab4e22c719a9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ef439fd547784f708f2bab4e22c719a9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">YARN</mark></span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/c5cf5fdbed3e4706a0654854bf879204" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">任务调度和集群资源管理。</span></span></li></ul><h3 id="https://www.notion.so/522caa5298964be894ee6d4dffa2f84d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/522caa5298964be894ee6d4dffa2f84d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">MapReduce</mark></span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/e15b30af9351416aa093427437dcc57f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">基于YARN的大型数据集并行处理系统。是一种计算模型，用以进行大数据量的计算。Hadoop的MapReduce实现，和Common、HDFS一起，构成了Hadoop发展初期的三个组件。</span></span><div id="https://www.notion.so/4e01a2186ba84b0f99c51c47d3416a05" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">MapReduce将应用划分为Map和Reduce两个步骤，其中Map对数据集上的独立元素进行指定的操作，生成键-值对形式中间结果；Reduce则对中间结果中相同“键”的所有“值”进行规约，以得到最终结果。MapReduce这样的功能划分，非常适合在大量计算机组成的分布式并行环境里进行数据处理。</span></span></p></div></li></ul><h3 id="https://www.notion.so/b94223b0498e46b1b43a14a5794f8a3d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b94223b0498e46b1b43a14a5794f8a3d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">Hive</mark></span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/639808340416414ab603ae7226b32de3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供简单的sql查询功能，可以将sql语句转换为MapReduce任务进行运行。 </span></span></li><li id="https://www.notion.so/4e6f4ba68d9047aa9731566ee70986db" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">优点是学习成本低，可以通过类SQL语句快速实现简单的MapReduce统计，不必开发专门的MapReduce应用，十分适合数据仓库的统计分析。</span></span></li></ul><h1 id="https://www.notion.so/e5fe4d03bc1b490f83e45d5cd540761d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/e5fe4d03bc1b490f83e45d5cd540761d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Hadoop和Spark 的区别</mark></span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/f685cb359388462b951262712dd289f2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">目的</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/233336ebdd5043b29d2abe71d848e338" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Hadoop和Spark二者都是大数据框架。Hadoop是一个分布式的数据基础设施，它是将庞大的数据集分派到由若干台计算机组成的集群中的多个节点进行存储。</span></span></li><li id="https://www.notion.so/944a16c3eed94d20824bbfa0345e4c12" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark是一个专门用来对那些分布式存储的大数据进行处理的工具，spark本身并不会进行分布式数据的存储。</span></span></li></ul></li><li id="https://www.notion.so/9c04c25fef394965a2781c8b6d8c6425" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">部署</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/a1967f27c06b48d580e468767ace6eaf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Hadoop的框架最核心的设计是：HDFS和MapReduce。HDFS为海量的数据提供了存储，则MapReduce为海量的数据提供了计算。所以使用Hadoop则可以抛开spark，而直接使用Hadoop自身的mapreduce完成数据的处理。</span></span></li><li id="https://www.notion.so/5ae47bc55bd64570bb631ea243b7346a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark不提供文件管理系统，但也不是只能依附在Hadoop上，它同样可以选择其他的基于云的数据系统平台，但spark默认的一般选择的还是hadoop。</span></span></li></ul></li><li id="https://www.notion.so/0c73fed676b744bf94b63bf0a3607124" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">数据处理速度</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/ab2ba90e791d4db4bb39341211226990" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark拥有Hadoop、 MapReduce所具有能更好地适用于数据挖掘与机器学习等需要迭代的的优点。但不同于MapReduce的是Job中间输出结果可以保存在内存中，从而不再需要读写HDFS。</span></span></li><li id="https://www.notion.so/71983695a380470b9fd15923cf995ca7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark和Hadoop的不同之处使Spark在某些工作负载方面表现得更加优越。换言之，Spark 启用了内存分布数据集，除了能够提供交互式查询外，它还可以优化迭代工作负载。</span></span></li></ul></li><li id="https://www.notion.so/a2454d4b096f4c168a3580165b250de5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">数据安全恢复</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/dd01a788186a47a58563dba6e1ecc380" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Hadoop每次处理的后的数据是写入到磁盘上，所以其天生就能很有弹性的从而对系统的错误进行处理。</span></span></li><li id="https://www.notion.so/c7a63eb62dd34ca8806941b0aa99a36f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark的数据对象存储在分布于数据集群中的叫做</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">弹性分布式数据集(Spark RDD)</strong></span><span class="SemanticString">中，这些数据对象既可以放在内存，也可以放在磁盘，所以spark同样可以完成数据的安全恢复。</span></span></li></ul></li></ul><h1 id="https://www.notion.so/698f64a430fc46479ae82925e3c93ab0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/698f64a430fc46479ae82925e3c93ab0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">Spark是什么？</mark></span></span></h1><h2 id="https://www.notion.so/905b26b344794fb6ba2e67dcf0336e8d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/905b26b344794fb6ba2e67dcf0336e8d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">基本概览</mark></span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/ae7bd56b1ba84166a9f9a62940e04601" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Apache Spark 是一种用于大数据工作负载的分布式开源处理系统。它使用内存中缓存和优化的查询执行方式，可针对任何规模的数据进行快速分析查询。</span></span></li><li id="https://www.notion.so/72853045ebae442f8c2018141b42c0ab" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">内置了 SQL、流式传输、机器学习和图处理模块。Spark 可以在云中针对不同的数据源在 Apache Hadoop、Apache Mesos、Kubernetes 上运行，也可以独立运行。</span></span></li><li id="https://www.notion.so/150083c65c5a4193a59cb11189c440af" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark也提供使用 Java、Scala、Python 和 R 语言的开发 API，支持跨多个工作负载重用代码—批处理、交互式查询、实时分析、机器学习和图形处理等。</span></span></li><li id="https://www.notion.so/5c318024049046ce8812af4a91cf6260" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Motivation</span></span><div id="https://www.notion.so/d147cb0e062b49d98fc421a9ae9c2ff8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Hadoop MapReduce 是一种用于处理大数据集的编程模型，它采用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">并行的分布式算法</strong></span><span class="SemanticString">。开发人员可以编写高度并行化的运算符，而不用担心工作分配和容错能力。不过，MapReduce 所面对的一项挑战是它要通过连续多步骤流程来运行某项作业。在每个步骤中，MapReduce 要读取来自集群的数据，执行操作，并将结果写到 HDFS。因为每个步骤都需要磁盘读取和写入，磁盘 I/O 的延迟会导致 MapReduce 作业变慢。</span></span></p></div><div id="https://www.notion.so/43c67198daa94cedafa0b0143a1ebc93" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">开发 Spark 的初衷就是为了突破 MapReduce 的这些限制</strong></span><span class="SemanticString">，它可以执行内存中处理，减少作业中的步骤数量，并且跨多项并行操作对数据进行重用。借助于 Spark，将数据读取到内存、执行操作和写回结果仅需要一个步骤，大大地加快了执行的速度。Spark 还能使用内存中缓存显著加快在相同数据集上重复调用某函数的机器学习算法的速度，进而重新使用数据。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据重用通过在弹性分布式数据集 (RDD) 上创建数据抽象—DataFrames 得以实现，而弹性分布式数据集是一个缓存在内存中并在多项 Spark 操作中重新使用的对象集合。</strong></span><span class="SemanticString">它大幅缩短了延迟，使 Spark 比 MapReduce 快数倍，在进行机器学习和交互式分析时尤其明显。</span></span></p></div></li></ul><h2 id="https://www.notion.so/3d5a2139f5c94cc4b0b89b7054975f32" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/3d5a2139f5c94cc4b0b89b7054975f32"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">Spark 生态系统包含五个关键组件</mark></span></span></h2><ol class="NumberedListWrapper"><li id="https://www.notion.so/d4d6859bbd80432da5b02ebd5537f8c8" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">Spark Core：通用的分布式数据处理引擎。在其上有 SQL、流式处理、机器学习和图计算的库，所有这些库都可以在应用中一起使用。Spark Core 是整个项目的基础，提供分布式任务调度、安排和基本的 I/O 功能。</span></span></li><li id="https://www.notion.so/b484843fe9444d13b24a8f4c5622bc38" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Spark SQL：处理结构化数据的 Spark 模块，支持访问各种数据源的通用方法。用户使用 SQL 或 DataFrame API 在 Spark 程序中查询</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">结构化数据</strong></span><span class="SemanticString">。Spark SQL 支持 HiveQL 语法，并允许访问现有的 Apache Hive 仓库。服务器模式通过 Java 数据库连接或开放数据库连接提供标准连接。</span></span></li><li id="https://www.notion.so/16ed88648e8e421db0825078ef1cb733" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Spark Streaming：支持轻松构建可扩缩、具有容错性的流式解决方案。它将集成了 Spark 语言的 API 引入流处理中，可以像编写批量作业一样编写流式作业。Spark Streaming 支持 Java、Scala 和 Python等语言。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">流处理</strong></span><span class="SemanticString">是指数据以某些外部系统或多个外部系统产生的事件的连续“流”形式进入处理引擎，并且处理引擎的运行速度非常快，以至于所有决策都无需停止数据流和首先存储信息。</span></span></li><li id="https://www.notion.so/bc300efd90764a59b0e83cd366da7878" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">MLlib：Spark 可扩容的机器学习库，它所提供的工具可以简化实际的机器学习并为其扩容。</span></span></li><li id="https://www.notion.so/35ea8de11de444db9aaf0b249c02c6ee" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString">GraphX：用于图和图并行计算的 Spark API。具有高灵活性，可以无缝处理图和集合 - 统一提取、转换、加载；进行探索性分析；在一个系统中迭代图计算。除了灵活性较高的 API 外，GraphX 还提供了多种图算法。同时具备 Spark 的灵活性、容错性和易用性。</span></span></li></ol><h2 id="https://www.notion.so/8f34a0b532dc4e809e99f7fa96700e95" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8f34a0b532dc4e809e99f7fa96700e95"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">KEY TERMS</mark></span></span></h2><h3 id="https://www.notion.so/34dbdd9934a143dbb8689c847a88332f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/34dbdd9934a143dbb8689c847a88332f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">RDD</mark></span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/8524600f5e6f47a79307525237fb6ca6" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">定义</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/5c237cd49aab4248b6bc84c5ee238ba4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">RDD（Resilient Distributed Dataset）叫做分布式数据集，是Spark中最基本的数据抽象。代码中是一个抽象类，它代表一个不可变、可分区、里面的元素可并行计算的集合。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/53bc249cc7c44bbdb33530c1d1aae049" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Dataset：一个数据集合，用于存放数据的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">(本地集合：都在一个进程中)。</strong></span></span></li><li id="https://www.notion.so/bbe2409931d342b2944114cddcabd884" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Distributed：RDD中的数据是分布式存储的，可用于分布式计算</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">(跨机器跨进程)</strong></span></span></li><li id="https://www.notion.so/0177a1edbfca4b079e78f78655689ecf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Resilient：RDD中的数据可以存储在内存中或者磁盘中。</span></span></li></ul></li><li id="https://www.notion.so/4afd53ec9eda47d19fbd3a97bbf1f516" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">在分布式计算中，需要分区控制，Shuffle控制，数据存储\序列化\发送，数据计算API ，等一系列功能。这些功能，不能简单的通过Python内置的本地集合对象(如 List，字典等)去完成。我们在分布式框架中，需要有一个统一的数据抽象对象，来实现上述分布式计算所需功能，这个抽象对象就是RDD。</span></span></li><li id="https://www.notion.so/ba79916657fe491faae3f18a2e627710" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">所有的运算以及操作都建立在 RDD 数据结构的基础之上。</span></span></li><li id="https://www.notion.so/d5661aaec6544575b3acea9b5839b04b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">可以认为RDD是分布式的List或Array，抽象的数据结构，RDD是一个抽象类Abstract Class和泛型Generic Type。</span></span></li></ul></li><li id="https://www.notion.so/2e08f492d51f4510872e432e35d20d73" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">特性</strong></span></span><ol class="NumberedListWrapper"><li id="https://www.notion.so/cc57cdc3bc5544c69e931ec095983a78" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">分区列表（a list of partitions）</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/9db6445d6c8f4e5ea5118783e24c7f15" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Spark RDD逻辑上是被分区的，每个分区的数据是抽象存在。</span></span></li><li id="https://www.notion.so/9e1e753db12441b4bf0eaeeb3b715a65" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">每一个分区都会被一个计算任务（Task）处理，分区数决定并行计算数量，RDD的并行度默认从父RDD传给子RDD。可以在创建RDD时指定RDD分片个数，如果不指定分区数量，当RDD从程序内存中已有的集合对象创建时，则默认分区数量就是程序所分配到的CPU核数（每个Core可以承载2～4个Partition），如果是从HDFS文件创建，默认分区数为HDFS文件的Block数。</span></span></li></ul></li><li id="https://www.notion.so/18b59d91b3a34ada988fa80ee5171bcc" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">每一个分区都有一个计算函数（a function for computing each split）</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/7274965358f44bd8b2eed24630267c71" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">每个分区都会有计算函数，Spark的RDD的计算函数是以分片为基本单位的，每个RDD都会实现compute计算函数，对具体的分片进行计算；RDD中的分片是并行的，所以是分布式并行计算。</span></span></li><li id="https://www.notion.so/a85685bb781a4cc1b9bb4f83c5740fd9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">计算的时候会通过一个compute函数得到</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">每个分区的数据</strong></span><span class="SemanticString">。如果RDD是通过已有的文件系统构建，则compute函数是读取指定文件系统中的数据，如果RDD是通过其他RDD转换而来，则compute函数是执行转换逻辑将其他RDD的数据进行转换。</span></span></li></ul></li><li id="https://www.notion.so/a43f7cca0f6f46659cfc85ec61d5b7cb" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">依赖于其他RDD的列表（a list of dependencies on other RDDs）</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/b6a01f47d3be42eb8d1e4ea35feabd9b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">RDD间有依赖关系，RDD都会有一个依赖的链条，称之为血缘关系，RDD之间进行迭代计算，和mapreduce的相似。我们总是由一个RDD计算产生新的RDD再由新的RDD迭代计算产生新的RDD，最后产生结果。</span></span></li><li id="https://www.notion.so/37a2d37e710048ba960594e29af71a30" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">因为有前后的依赖关系，所以当有分区数据丢失的时候，Spark会通过依赖关系重新计算，算出丢失的数据，而不是对RDD所有的分区进行重新计算。RDD之间的依赖有两种：窄依赖（Narrow Dependency）、宽依赖（Wide Dependency）。RDD是Spark的核心数据结构，通过RDD的依赖关系形成调度关系。通过对RDD的操作形成整个Spark程序。</span></span></li></ul></li><li id="https://www.notion.so/489885d5d1134816b1680493f46ad9e9" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">key-value数据类型的RDD分区器（Optionally, a Partitioner for key-value RDDS）</span></span><div id="https://www.notion.so/3da12d1bd029440799c799f8052a415c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">控制分区策略和分区数。每个key-value形式的RDD都有Partitioner属性，它决定了RDD如何分区。当然，Partition的个数还决定每个Stage的Task个数。Partitioner是针对key-value的形式，如果不是key-value的形式，它就不会有具体的Partitioner。用户可以自定义分区策略，如Hash分区等。</span></span></p></div></li><li id="https://www.notion.so/b66d1bb07cd94de59d9cc7315062a566" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString">每个分区都有一个优先位置列表（Optionally, a list of preferred locations to compute each split on）</span></span><div id="https://www.notion.so/c03d6039a072452dadd68500a550d58d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">它会存储每个Partition的优先位置，对于一个HDFS文件来说，就是每个Partition块的位置。在具体分片前，它已经清楚地知道任务发生在什么节点上，也就是说，任务本身是计算层面的、代码层面的，代码发生运算之前已经知道它要运算的数据在什么地方，有具体节点的信息。</span></span></p></div><div id="https://www.notion.so/3e4040f7873240f3872f184be7960c17" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">数据不动代码动的特点：数据不动代码动的最理想情况就是数据就在当前节点的内存中。Spark本身在进行任务调度时候，会尽可能将task任务分配到处理数据的数据块所在的具体位置。</span></span></p></div></li></ol></li></ol><h3 id="https://www.notion.so/43816690f1dc4897adbf695430fc4701" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/43816690f1dc4897adbf695430fc4701"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPurple">DataFrame</mark></span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/29c398a33c52448b943d3ae0dacac5e0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">DataFrame的前身是SchemaRDD，从Spark 1.3.0开始SchemaRDD更名为DataFrame。</span></span></li><li id="https://www.notion.so/c6651f4c8699441eb29fd8a31cada95c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">与SchemaRDD的主要区别是：DataFrame不再直接继承自RDD，而是自己实现了RDD的绝大多数功能。你仍旧可以在DataFrame上调用rdd方法将其转换为一个RDD。</span></span></li><li id="https://www.notion.so/f4691e6da4c44b2080e4317adc97d28d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">在Spark中，DataFrame是一种</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">以RDD为基础的分布式数据集</strong></span><span class="SemanticString">，类似于传统数据库的二维表格，DataFrame带有Schema元信息，即DataFrame所表示的二维表数据集的每一列都带有名称和类型，但底层做了更多的优化。DataFrame可以从很多数据源构建，比如：已经存在的RDD、结构化文件、外部数据库、Hive表。</span></span></li></ul><div id="https://www.notion.so/65cd49c9e5144011be2d2cda6db65758" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">DataFrame是一个二维表结构，那么表格结构为： • 行 • 列 • </span></span></p></div><div id="https://www.notion.so/0483994d0ed64d1e9f63eb7e0319f7e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">表结构描述 DataFrame的组成如下：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/dcedfacad214422285a82f2fdf64fc0c" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">StructType对象描述整个DataFrame的表结构</span></span></li><li id="https://www.notion.so/380ed0460e4649a5bcbe496aca67e9b8" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">StructField对象描述一个列在数据层面的信息</span></span></li><li id="https://www.notion.so/0c17f3ec0cf84a1586f891c5bcf47e0b" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Row对象记录一行数据</span></span></li><li id="https://www.notion.so/125dedb407d64ad2b92c4ddee360a9bf" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">Column对象记录一列数据并包含列的信息</span></span></li></ol><div id="https://www.notion.so/1790b241b21d4faa9cedecdcabb788b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">RDD可看作是分布式的对象的集合，Spark并不知道对象的详细模式信息，DataFrame可看作是分布式的Row对象的集合，其提供了由列组成的详细模式信息，使得Spark SQL可以进行某些形式的执行优化。</span></span></p></div><div id="https://www.notion.so/f34adc3af4c240538d45935e1781e2c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">EXAMPLE</span></span></p></div><div id="https://www.notion.so/261d7a22f18d4b6e8bc9cd8f58f135e9" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3fc9c4ee-1cb1-4f1f-ba1c-31d702ada45c%2FUntitled.png?width=840&amp;table=block&amp;id=261d7a22-f18d-4b6e-8bc9-cd8f58f135e9"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3fc9c4ee-1cb1-4f1f-ba1c-31d702ada45c%2FUntitled.png?width=840&amp;table=block&amp;id=261d7a22-f18d-4b6e-8bc9-cd8f58f135e9" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>
  <footer class="Footer">
  <div>&copy; Welcome to Robin’s Blog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>